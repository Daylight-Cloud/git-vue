import{_ as A,u as F,r as y,v as b,o as H,c,b as r,d as e,t as l,F as f,z as w,p,e as g,w as u,s as k,g as n,m as L}from"./index-C2iAr7MH.js";const P={class:"user-home"},$={class:"hero-card"},z={class:"subtitle"},E={class:"stat-grid"},I={class:"recent-section"},M={class:"sec-head"},R={class:"timeline-row"},T={__name:"UserHome",setup(j){const d=F(),a=y({borrowing:0,returned:0,totalBooks:0}),i=y([]),_=b(()=>d.profile),h=b(()=>[{label:"åœ¨å€Ÿå›¾ä¹¦",value:a.value.borrowing,tip:"è¿˜ä¹¦åˆ«å¿˜è®°å“¦ï½ž"},{label:"å·²è¯»å®Œ",value:a.value.returned,tip:"é˜…è¯»è·¯ä¸Šçš„è„šå°"},{label:"é¦†è—æ€»é‡",value:a.value.totalBooks,tip:"æŽ¢ç´¢æ–°çš„ä¹¦ç±"}]),B=o=>o?new Date(o).toLocaleDateString():"--",C=async()=>{try{a.value=await k.get("/my/stats")}catch(o){console.error("èŽ·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:",o),a.value={borrowing:0,returned:0,totalBooks:0}}},S=async()=>{try{const o=await k.get("/my/borrow");i.value=Array.isArray(o)?o.slice(0,4):[]}catch(o){console.error("èŽ·å–å€Ÿé˜…è®°å½•å¤±è´¥:",o),i.value=[]}};return H(async()=>{try{d.profile||await d.fetchProfile(),await Promise.all([C(),S()])}catch(o){console.error("åˆå§‹åŒ–å¤±è´¥:",o)}}),(o,t)=>{var m,v;const x=n("el-button"),D=n("el-empty"),N=n("el-image"),U=n("el-timeline-item"),V=n("el-timeline");return r(),c("div",P,[e("section",$,[e("div",null,[e("p",z,"å—¨ï¼Œ"+l(((m=_.value)==null?void 0:m.nickname)||((v=_.value)==null?void 0:v.username)||"ä¹¦å‹"),1),t[1]||(t[1]=e("h1",null,"æ¬¢è¿Žæ¥åˆ°ä½ çš„çŸ¥è¯†å®‡å®™",-1)),t[2]||(t[2]=e("p",{class:"desc"},"æŸ¥çœ‹å€Ÿé˜…è¿›åº¦ã€å‘çŽ°å¥½ä¹¦ï¼Œå¼€å¯ä»Šå¤©çš„é˜…è¯»æ—…ç¨‹ã€‚",-1))]),t[3]||(t[3]=e("div",{class:"hero-illustration"},"ðŸ“š",-1))]),e("section",E,[(r(!0),c(f,null,w(h.value,s=>(r(),c("div",{class:"stat-card",key:s.label},[e("p",null,l(s.label),1),e("h2",null,l(s.value),1),e("small",null,l(s.tip),1)]))),128))]),e("section",I,[e("div",M,[t[5]||(t[5]=e("h2",null,"æœ€è¿‘å€Ÿé˜…",-1)),g(x,{link:"",type:"primary",onClick:t[0]||(t[0]=s=>o.$router.push("/user/borrow"))},{default:u(()=>t[4]||(t[4]=[L("æŸ¥çœ‹å…¨éƒ¨")])),_:1,__:[4]})]),i.value.length?(r(),p(V,{key:1},{default:u(()=>[(r(!0),c(f,null,w(i.value,s=>(r(),p(U,{key:s.id,timestamp:B(s.borrow_date),type:s.status==="borrowed"?"warning":"success"},{default:u(()=>[e("div",R,[e("div",null,[e("strong",null,l(s.book_title),1),e("p",null,l(s.status==="borrowed"?"å€Ÿé˜…ä¸­":"å·²å½’è¿˜"),1)]),g(N,{src:s.cover_url,fit:"cover",class:"timeline-cover"},{error:u(()=>t[6]||(t[6]=[e("div",{class:"timeline-cover empty"},"No Cover",-1)])),_:2},1032,["src"])])]),_:2},1032,["timestamp","type"]))),128))]),_:1})):(r(),p(D,{key:0,description:"æš‚æ— å€Ÿé˜…è®°å½•"}))])])}}},G=A(T,[["__scopeId","data-v-0e509921"]]);export{G as default};
